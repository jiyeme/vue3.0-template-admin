import{P as e,A as s}from"./vendor.46a65300.js";import{s as r,a as o}from"./index.fe9ae1b8.js";const t=e.create({baseURL:"/api",timeout:1e4,withCredentials:!1});t.interceptors.request.use((e=>{const{token:s}=r.state;return s&&(e.headers.Authorization=`Bearer ${s}`),e}),(e=>(console.log("request error",e),Promise.reject(e)))),t.interceptors.response.use((e=>{if(console.log("response",e),200!==e.status)return Promise.reject(e);const r=e.data;return r.code&&200!==r.code?(console.log("状态码异常",r),r.msg&&s.ElMessage({message:r.msg,center:!0,type:"error"}),Promise.reject(r)):e.data}),(e=>{if(console.log("请求出现异常 - ",e),console.log("错误对象类型 - ",Object.prototype.toString.call(e)),console.log("error.name",e.name),console.log("error.message",e.message),console.log("error.code",e.code),console.log("error.status",e.status),"Network Error"===e.message)return s.ElMessage({message:"网络错误！",center:!0,type:"error"}),Promise.reject(e);if(e.message.includes("timeout"))return s.ElMessage({message:"响应超时",center:!0,type:"error"}),Promise.reject(e);const t=e.response,a=t.data||null;if(console.log(t),t&&t.status)switch(t.status){case 401:s.ElMessage({message:"未登录",center:!0}),localStorage.removeItem("token"),r.commit("set_isLogin",!1),o.push({path:"/user/login",query:{redirect:o.currentRoute.value.fullPath}});break;case 403:s.ElMessage({message:"你没有权限执行该操作",center:!0});break;case 404:s.ElMessage({message:"接口不存在！",center:!0});break;default:a.error?s.ElMessage({message:a.error,center:!0,type:"error"}):s.ElMessage({message:"请求发生异常1！",center:!0,type:"error"})}else s.ElMessage({message:"请求发生异常2！",center:!0,type:"error"});return console.log(" ==== axios尝试处理异常结束 ==== "),Promise.reject(e)}));export{t as r};
